% test script for pseudospectral method


iAb=@(p) p^4;
A=@(p) 1; 
b=@(p) p^4;
Ax=@(p,x) x;
s=parameter();
iAb2=@(p) p(1)^4*p(2)^9;
A2=@(p) 1; 
b2=@(p) p(1)^4*p(2)^9;
Ax2=@(p,x) x;
s2=[parameter(); parameter()];


Y=pseudospectral(iAb,s,10);
Y2=pseudospectral(iAb2,s2,10);


[X,errz]=pseudospectral(iAb,s,5);
[X,errz]=pseudospectral(iAb2,s2,[5 5]);
[X,errz]=pseudospectral(iAb2,s2,[5 7]);
[X,errz]=pseudospectral(iAb,s,'adapt');
[X,errz]=pseudospectral(iAb,s,'adapt','convtype','mincoeff');
[X,errz]=pseudospectral(iAb2,s2,'adapt','convtype','mincoeff');
[X,errz]=pseudospectral(iAb,s,'adapt','convtype','relerr');
[X,errz]=pseudospectral(iAb2,s2,'adapt','convtype','relerr');
[X,errz]=pseudospectral(iAb,s,'adapt','refsoln',Y);
[X,errz]=pseudospectral(iAb2,s2,'adapt','refsoln',Y2);

[X,errz]=pseudospectral(iAb,s,'adapt','convtype','resid','matfun',A,'vecfun',b);
[X,errz]=pseudospectral(iAb2,s2,'adapt','convtype','resid','matfun',A2,'vecfun',b2);

[X,errz]=pseudospectral(iAb,s,'adapt','convtype','resid','matvecfun',Ax);
[X,errz]=pseudospectral(iAb2,s2,'adapt','convtype','resid','matvecfun',Ax2);

%matlabpool('open',2);
%[X,errz]=pseudospectral(iAb,s,'adapt','convtype','relerr','parallel',1);
%[X,errz]=pseudospectral(iAb2,s2,'adapt','convtype','relerr','parallel',1);
%matlabpool('close');




